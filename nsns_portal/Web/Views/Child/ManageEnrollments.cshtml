


<script src="/js/enrollments.js"></script>
@model Core.ViewModels.ManageEnrollmentsViewModel

<div>
    <p><strong>Name:</strong> @Model.Child.Name</p>
    <p><strong>Birth Date:</strong> @(Model.Child.BirthDate.HasValue ? Model.Child.BirthDate.Value.ToString("yyyy-MM-dd") : "N/A")</p>
    <p><strong>Gender:</strong> @Model.Child.Gender</p>
    <p><strong>City:</strong> @(Model.Child.City != null ? Model.Child.City.Name : "N/A")</p>
</div>

<div style="border-top: 2px solid #ddd; margin: 20px 0;"></div>

<!-- ✅ Table Showing Already Enrolled Courses -->
<h3 style="color: 007bff">Enrolled Courses</h3>

<table style="border-collapse: collapse; width: 100%; text-align: left;">
    <thead>
        <tr style="background-color: #f2f2f2;">
            <th style="padding: 8px; border: 1px solid #ddd;">Course Title</th>
            <th style="padding: 8px; border: 1px solid #ddd;">Specialty</th>
            <th style="padding: 8px; border: 1px solid #ddd;">Coach</th>
            <th style="padding: 8px; border: 1px solid #ddd;">Scheduled Hours</th>
            <th style="padding: 8px; border: 1px solid #ddd;">Status</th>
            <th style="padding: 8px; border: 1px solid #ddd;">Actions</th>
        </tr>
    </thead>
    <tbody>
        @if (Model.CourseEnrollments.Any())
        {

            foreach (var enrollment in Model.CourseEnrollments)

            {
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">@enrollment.Course.Title</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">@enrollment.Course.Coach.Specialty.Title</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">@enrollment.Course.Coach.Name</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">@enrollment.ScheduledHours</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">@enrollment.Status</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">
                        <form method="post" action="/Child/RemoveEnrollment">
                            <input type="hidden" name="enrollmentId" value="@enrollment.EnrollmentID" />
                            <input type="hidden" name="childId" value="@enrollment.ChildID" />
                            <button type="submit" style="background-color: #ff4d4d; color: white; padding: 5px 10px; border: none; cursor: pointer;">
                                Remove
                            </button>
                        </form>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="6" style="text-align: center; padding: 10px;">No courses enrolled.</td>
            </tr>
        }

         @if (TempData["SuccessMessage"] != null)
        {
            <tr>
                <td colspan="6">
                    <div class="alert alert-success">
                        @TempData["SuccessMessage"]
                    </div>
                </td>
            </tr>
        }

        @if (TempData["ErrorMessage"] != null)
        {
            <tr>
                <td colspan="6">
                    <div class="alert alert-success">
                        @TempData["ErrorMessage"]
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>


<div style="border-top: 2px solid #ddd; margin: 20px 0;"></div>



<b>Enroll @Model.Child.Name in Course</b>

<form method="post" action="/Child/Enroll">
    <input type="hidden" name="childId" value="@Model.Child.ChildID" />

    <!-- Select Specialty First -->
    <label for="specialtyId">Select Specialty:</label>
    <select id="specialtyId" name="specialtyId" required onchange="fetchCoursesBySpecialty(this.value)">
        <option value="">-- Select Specialty --</option>
        @foreach (var specialty in ViewBag.SpecialtyList)

        {
            <option value="@specialty.Value">@specialty.Text</option>
        }
    </select>

    <!-- Select Course Based on Specialty -->
    <label for="courseId">Select Course:</label>
    <select id="courseId" name="courseId" required>
        <option value="">-- Select Course --</option>
    </select>

    <label for="scheduledHours">Scheduled Hours:</label>
    <input type="number" name="scheduledHours" min="1" value="0" disabled required />

    <button type="submit" style="background-color: #ff4d4d; color: white; border: none; padding: 5px 10px; cursor: pointer;">Enroll</button>
</form>